============================= test session starts ==============================
platform linux -- Python 3.11.5, pytest-7.4.2, pluggy-1.3.0 -- /jet/home/ajmera/.conda/envs/CPET_ENV/bin/python
cachedir: .pytest_cache
rootdir: /jet/home/ajmera/programs/CPET-python
collecting ... collected 1 item

test_topology.py::Test_topos::test_topo_methods FAILED                   [100%]

=================================== FAILURES ===================================
_________________________ Test_topos.test_topo_methods _________________________

self = <test_topology.Test_topos object at 0x146dd6376810>

    def test_topo_methods(self):
        topo_function_list = [
            #self.topo.compute_topo,
            #self.topo.compute_topo_complete_c_shared,
            #self.topo.compute_topo_base,  - what are we doing with this one?
            self.topo.compute_topo_GPU_batch_filter
        ]
    
        for topo_function in topo_function_list:
            print("----"*15)
            hist = topo_function()
>           self.topo_equality(hist, topo_function)

test_topology.py:115: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
test_topology.py:98: in topo_equality
    np.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x146dcc891f80>, array([[0.01      , 0.09211456],
       [0.01      , 0.....,
       [2.8935437 , 1.4623419 ],
       [3.0631645 , 0.6282363 ],
       [3.1021862 , 0.44172978]], dtype=float32))
kwds = {'equal_nan': True, 'err_msg': 'Topo histograms are not equal for compute_topo_GPU_batch_filter', 'header': 'Not equal to tolerance rtol=0.01, atol=0.01', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=0.01, atol=0.01
E           Topo histograms are not equal for compute_topo_GPU_batch_filter
E           Mismatched elements: 2 / 2000 (0.1%)
E           Max absolute difference: 0.06943231
E           Max relative difference: 0.09776439
E            x: array([[0.01    , 0.092115],
E                  [0.01    , 0.109469],
E                  [0.01    , 0.16442 ],...
E            y: array([[0.01    , 0.092115],
E                  [0.01    , 0.109447],
E                  [0.01    , 0.16442 ],...

../../../.conda/envs/CPET_ENV/lib/python3.11/contextlib.py:81: AssertionError
----------------------------- Captured stdout call -----------------------------
------------------------------------------------------------
... > Computing Topo in Batches on a GPU!
Number of samples: 1000
Number of charges: 17391
Step size: 0.01
Filtering...
Streamline detected to hit both path and box at index: 4, checking now...
Streamline hit box first at index tensor(4, device='cuda:0')
Streamline detected to hit both path and box at index: 5, checking now...
Streamline hit path limit first at index tensor(5, device='cuda:0')
Streamline detected to hit both path and box at index: 25, checking now...
Streamline hit path limit first at index tensor(25, device='cuda:0')
Streamline detected to hit both path and box at index: 28, checking now...
Streamline hit path limit first at index tensor(28, device='cuda:0')
Streamline detected to hit both path and box at index: 36, checking now...
Streamline hit path limit first at index tensor(36, device='cuda:0')
Streamline detected to hit both path and box at index: 45, checking now...
Streamline hit box first at index tensor(45, device='cuda:0')
Streamline detected to hit both path and box at index: 50, checking now...
Streamline hit path limit first at index tensor(50, device='cuda:0')
Streamline detected to hit both path and box at index: 54, checking now...
Streamline hit path limit first at index tensor(54, device='cuda:0')
Streamline detected to hit both path and box at index: 68, checking now...
Streamline hit path limit first at index tensor(68, device='cuda:0')
Streamline detected to hit both path and box at index: 73, checking now...
Streamline hit path limit first at index tensor(73, device='cuda:0')
Streamline detected to hit both path and box at index: 75, checking now...
Streamline hit path limit first at index tensor(75, device='cuda:0')
Streamline detected to hit both path and box at index: 76, checking now...
Streamline hit box first at index tensor(76, device='cuda:0')
Streamline detected to hit both path and box at index: 80, checking now...
Streamline hit box first at index tensor(80, device='cuda:0')
Streamline detected to hit both path and box at index: 89, checking now...
Streamline hit box first at index tensor(89, device='cuda:0')
Streamline detected to hit both path and box at index: 90, checking now...
Streamline hit path limit first at index tensor(90, device='cuda:0')
Streamline detected to hit both path and box at index: 93, checking now...
Streamline hit box first at index tensor(93, device='cuda:0')
Streamline detected to hit both path and box at index: 94, checking now...
Streamline hit box first at index tensor(94, device='cuda:0')
Streamline detected to hit both path and box at index: 97, checking now...
Streamline hit box first at index tensor(97, device='cuda:0')
Streamline detected to hit both path and box at index: 99, checking now...
Streamline hit path limit first at index tensor(99, device='cuda:0')
Streamline detected to hit both path and box at index: 105, checking now...
Streamline hit path limit first at index tensor(105, device='cuda:0')
Streamline detected to hit both path and box at index: 108, checking now...
Streamline hit box first at index tensor(108, device='cuda:0')
Streamline detected to hit both path and box at index: 147, checking now...
Streamline hit path limit first at index tensor(147, device='cuda:0')
Streamline detected to hit both path and box at index: 149, checking now...
Streamline hit path limit first at index tensor(149, device='cuda:0')
Streamline detected to hit both path and box at index: 188, checking now...
Streamline hit path limit first at index tensor(188, device='cuda:0')
Streamline detected to hit both path and box at index: 192, checking now...
Streamline hit box first at index tensor(192, device='cuda:0')
Streamline detected to hit both path and box at index: 194, checking now...
Streamline hit path limit first at index tensor(194, device='cuda:0')
Streamline detected to hit both path and box at index: 196, checking now...
Streamline hit box first at index tensor(196, device='cuda:0')
Streamline detected to hit both path and box at index: 201, checking now...
Streamline hit path limit first at index tensor(201, device='cuda:0')
Streamline detected to hit both path and box at index: 211, checking now...
Streamline hit box first at index tensor(211, device='cuda:0')
Streamline detected to hit both path and box at index: 228, checking now...
Streamline hit path limit first at index tensor(228, device='cuda:0')
Streamline detected to hit both path and box at index: 248, checking now...
Streamline hit path limit first at index tensor(248, device='cuda:0')
Streamline detected to hit both path and box at index: 258, checking now...
Streamline hit box first at index tensor(258, device='cuda:0')
Streamline detected to hit both path and box at index: 280, checking now...
Streamline hit path limit first at index tensor(280, device='cuda:0')
Streamline detected to hit both path and box at index: 281, checking now...
Streamline hit path limit first at index tensor(281, device='cuda:0')
Streamline detected to hit both path and box at index: 287, checking now...
Streamline hit path limit first at index tensor(287, device='cuda:0')
Streamline detected to hit both path and box at index: 289, checking now...
Streamline hit box first at index tensor(289, device='cuda:0')
Streamline detected to hit both path and box at index: 296, checking now...
Streamline hit box first at index tensor(296, device='cuda:0')
Streamline detected to hit both path and box at index: 299, checking now...
Streamline hit box first at index tensor(299, device='cuda:0')
Streamline detected to hit both path and box at index: 300, checking now...
Streamline hit path limit first at index tensor(300, device='cuda:0')
Streamline detected to hit both path and box at index: 309, checking now...
Streamline hit box first at index tensor(309, device='cuda:0')
Streamline detected to hit both path and box at index: 317, checking now...
Streamline hit path limit first at index tensor(317, device='cuda:0')
Streamline detected to hit both path and box at index: 328, checking now...
Streamline hit box first at index tensor(328, device='cuda:0')
Streamline detected to hit both path and box at index: 350, checking now...
Streamline hit path limit first at index tensor(350, device='cuda:0')
Streamline detected to hit both path and box at index: 368, checking now...
Streamline hit path limit first at index tensor(368, device='cuda:0')
Streamline detected to hit both path and box at index: 369, checking now...
Streamline hit box first at index tensor(369, device='cuda:0')
Streamline detected to hit both path and box at index: 375, checking now...
Streamline hit path limit first at index tensor(375, device='cuda:0')
Streamline detected to hit both path and box at index: 383, checking now...
Streamline hit box first at index tensor(383, device='cuda:0')
Streamline detected to hit both path and box at index: 384, checking now...
Streamline hit box first at index tensor(384, device='cuda:0')
Streamline detected to hit both path and box at index: 386, checking now...
Streamline hit path limit first at index tensor(386, device='cuda:0')
Streamline detected to hit both path and box at index: 391, checking now...
Streamline hit box first at index tensor(391, device='cuda:0')
Streamline detected to hit both path and box at index: 394, checking now...
Streamline hit path limit first at index tensor(394, device='cuda:0')
Streamline detected to hit both path and box at index: 399, checking now...
Streamline hit box first at index tensor(399, device='cuda:0')
Streamline detected to hit both path and box at index: 407, checking now...
Streamline hit box first at index tensor(407, device='cuda:0')
Streamline detected to hit both path and box at index: 409, checking now...
Streamline hit path limit first at index tensor(409, device='cuda:0')
Streamline detected to hit both path and box at index: 449, checking now...
Streamline hit box first at index tensor(449, device='cuda:0')
Streamline detected to hit both path and box at index: 476, checking now...
Streamline hit path limit first at index tensor(476, device='cuda:0')
Streamline detected to hit both path and box at index: 479, checking now...
Streamline hit box first at index tensor(479, device='cuda:0')
Streamline detected to hit both path and box at index: 486, checking now...
Streamline hit path limit first at index tensor(486, device='cuda:0')
Streamline detected to hit both path and box at index: 495, checking now...
Streamline hit path limit first at index tensor(495, device='cuda:0')
Streamline detected to hit both path and box at index: 500, checking now...
Streamline hit path limit first at index tensor(500, device='cuda:0')
Streamline detected to hit both path and box at index: 518, checking now...
Streamline hit path limit first at index tensor(518, device='cuda:0')
Streamline detected to hit both path and box at index: 527, checking now...
Streamline hit path limit first at index tensor(527, device='cuda:0')
Streamline detected to hit both path and box at index: 538, checking now...
Streamline hit path limit first at index tensor(538, device='cuda:0')
Streamline detected to hit both path and box at index: 540, checking now...
Streamline hit box first at index tensor(540, device='cuda:0')
Streamline detected to hit both path and box at index: 550, checking now...
Streamline hit path limit first at index tensor(550, device='cuda:0')
Streamline detected to hit both path and box at index: 560, checking now...
Streamline hit box first at index tensor(560, device='cuda:0')
Streamline detected to hit both path and box at index: 582, checking now...
Streamline hit box first at index tensor(582, device='cuda:0')
Streamline detected to hit both path and box at index: 589, checking now...
Streamline hit box first at index tensor(589, device='cuda:0')
Streamline detected to hit both path and box at index: 590, checking now...
Streamline hit box first at index tensor(590, device='cuda:0')
Streamline detected to hit both path and box at index: 594, checking now...
Streamline hit box first at index tensor(594, device='cuda:0')
Streamline detected to hit both path and box at index: 597, checking now...
Streamline hit box first at index tensor(597, device='cuda:0')
Streamline detected to hit both path and box at index: 607, checking now...
Streamline hit path limit first at index tensor(607, device='cuda:0')
Streamline detected to hit both path and box at index: 617, checking now...
Streamline hit path limit first at index tensor(617, device='cuda:0')
Streamline detected to hit both path and box at index: 621, checking now...
Streamline hit path limit first at index tensor(621, device='cuda:0')
Streamline detected to hit both path and box at index: 628, checking now...
Streamline hit path limit first at index tensor(628, device='cuda:0')
Streamline detected to hit both path and box at index: 639, checking now...
Streamline hit path limit first at index tensor(639, device='cuda:0')
Streamline detected to hit both path and box at index: 640, checking now...
Streamline hit path limit first at index tensor(640, device='cuda:0')
Streamline detected to hit both path and box at index: 648, checking now...
Streamline hit path limit first at index tensor(648, device='cuda:0')
Streamline detected to hit both path and box at index: 649, checking now...
Streamline hit box first at index tensor(649, device='cuda:0')
Streamline detected to hit both path and box at index: 659, checking now...
Streamline hit box first at index tensor(659, device='cuda:0')
Streamline detected to hit both path and box at index: 686, checking now...
Streamline hit path limit first at index tensor(686, device='cuda:0')
Streamline detected to hit both path and box at index: 689, checking now...
Streamline hit path limit first at index tensor(689, device='cuda:0')
Streamline detected to hit both path and box at index: 692, checking now...
Streamline hit box first at index tensor(692, device='cuda:0')
Streamline detected to hit both path and box at index: 693, checking now...
Streamline hit path limit first at index tensor(693, device='cuda:0')
Streamline detected to hit both path and box at index: 699, checking now...
Streamline hit path limit first at index tensor(699, device='cuda:0')
Streamline detected to hit both path and box at index: 709, checking now...
Streamline hit path limit first at index tensor(709, device='cuda:0')
Streamline detected to hit both path and box at index: 710, checking now...
Streamline hit box first at index tensor(710, device='cuda:0')
Streamline detected to hit both path and box at index: 718, checking now...
Streamline hit path limit first at index tensor(718, device='cuda:0')
Streamline detected to hit both path and box at index: 739, checking now...
Streamline hit path limit first at index tensor(739, device='cuda:0')
Streamline detected to hit both path and box at index: 741, checking now...
Streamline hit path limit first at index tensor(741, device='cuda:0')
Streamline detected to hit both path and box at index: 750, checking now...
Streamline hit path limit first at index tensor(750, device='cuda:0')
Streamline detected to hit both path and box at index: 769, checking now...
Streamline hit box first at index tensor(769, device='cuda:0')
Streamline detected to hit both path and box at index: 779, checking now...
Streamline hit path limit first at index tensor(779, device='cuda:0')
Streamline detected to hit both path and box at index: 783, checking now...
Streamline hit path limit first at index tensor(783, device='cuda:0')
Streamline detected to hit both path and box at index: 787, checking now...
Streamline hit box first at index tensor(787, device='cuda:0')
Streamline detected to hit both path and box at index: 790, checking now...
Streamline hit box first at index tensor(790, device='cuda:0')
Streamline detected to hit both path and box at index: 791, checking now...
Streamline hit path limit first at index tensor(791, device='cuda:0')
Streamline detected to hit both path and box at index: 794, checking now...
Streamline hit path limit first at index tensor(794, device='cuda:0')
Streamline detected to hit both path and box at index: 809, checking now...
Streamline hit box first at index tensor(809, device='cuda:0')
Streamline detected to hit both path and box at index: 810, checking now...
Streamline hit path limit first at index tensor(810, device='cuda:0')
Streamline detected to hit both path and box at index: 819, checking now...
Streamline hit path limit first at index tensor(819, device='cuda:0')
Streamline detected to hit both path and box at index: 829, checking now...
Streamline hit box first at index tensor(829, device='cuda:0')
Streamline detected to hit both path and box at index: 837, checking now...
Streamline hit path limit first at index tensor(837, device='cuda:0')
Streamline detected to hit both path and box at index: 847, checking now...
Streamline hit path limit first at index tensor(847, device='cuda:0')
Streamline detected to hit both path and box at index: 859, checking now...
Streamline hit box first at index tensor(859, device='cuda:0')
Streamline detected to hit both path and box at index: 868, checking now...
Streamline hit path limit first at index tensor(868, device='cuda:0')
Streamline detected to hit both path and box at index: 877, checking now...
Streamline hit path limit first at index tensor(877, device='cuda:0')
Streamline detected to hit both path and box at index: 881, checking now...
Streamline hit box first at index tensor(881, device='cuda:0')
Streamline detected to hit both path and box at index: 882, checking now...
Streamline hit path limit first at index tensor(882, device='cuda:0')
Streamline detected to hit both path and box at index: 887, checking now...
Streamline hit path limit first at index tensor(887, device='cuda:0')
Streamline detected to hit both path and box at index: 891, checking now...
Streamline hit path limit first at index tensor(891, device='cuda:0')
Streamline detected to hit both path and box at index: 894, checking now...
Streamline hit box first at index tensor(894, device='cuda:0')
Streamline detected to hit both path and box at index: 897, checking now...
Streamline hit box first at index tensor(897, device='cuda:0')
Streamline detected to hit both path and box at index: 898, checking now...
Streamline hit box first at index tensor(898, device='cuda:0')
Streamline detected to hit both path and box at index: 908, checking now...
Streamline hit path limit first at index tensor(908, device='cuda:0')
Streamline detected to hit both path and box at index: 911, checking now...
Streamline hit box first at index tensor(911, device='cuda:0')
Streamline detected to hit both path and box at index: 930, checking now...
Streamline hit box first at index tensor(930, device='cuda:0')
Streamline detected to hit both path and box at index: 941, checking now...
Streamline hit path limit first at index tensor(941, device='cuda:0')
Streamline detected to hit both path and box at index: 948, checking now...
Streamline hit path limit first at index tensor(948, device='cuda:0')
Streamline detected to hit both path and box at index: 950, checking now...
Streamline hit path limit first at index tensor(950, device='cuda:0')
Streamline detected to hit both path and box at index: 951, checking now...
Streamline hit path limit first at index tensor(951, device='cuda:0')
Streamline detected to hit both path and box at index: 956, checking now...
Streamline hit path limit first at index tensor(956, device='cuda:0')
Streamline detected to hit both path and box at index: 967, checking now...
Streamline hit path limit first at index tensor(967, device='cuda:0')
Streamline detected to hit both path and box at index: 970, checking now...
Streamline hit path limit first at index tensor(970, device='cuda:0')
Streamline detected to hit both path and box at index: 976, checking now...
Streamline hit box first at index tensor(976, device='cuda:0')
Streamline detected to hit both path and box at index: 977, checking now...
Streamline hit box first at index tensor(977, device='cuda:0')
Streamline detected to hit both path and box at index: 979, checking now...
Streamline hit box first at index tensor(979, device='cuda:0')
Streamline detected to hit both path and box at index: 993, checking now...
Streamline hit box first at index tensor(993, device='cuda:0')
Streamline detected to hit both path and box at index: 995, checking now...
Streamline hit path limit first at index tensor(995, device='cuda:0')
Streamline detected to hit both path and box at index: 997, checking now...
Streamline hit box first at index tensor(997, device='cuda:0')
Streamline detected to hit both path and box at index: 998, checking now...
Streamline hit box first at index tensor(998, device='cuda:0')
Streamline detected to hit both path and box at index: 999, checking now...
Streamline hit path limit first at index tensor(999, device='cuda:0')
Now have 656 number of dumped streamlines after filtering.
Number of streamlines filtered: 656
656
Filtering...
Streamline detected to hit both path and box at index: 20, checking now...
Streamline hit box first at index tensor(20, device='cuda:0')
Streamline detected to hit both path and box at index: 25, checking now...
Streamline hit box first at index tensor(25, device='cuda:0')
Streamline detected to hit both path and box at index: 41, checking now...
Streamline hit path limit first at index tensor(41, device='cuda:0')
Streamline detected to hit both path and box at index: 45, checking now...
Streamline hit path limit first at index tensor(45, device='cuda:0')
Streamline detected to hit both path and box at index: 48, checking now...
Streamline hit box first at index tensor(48, device='cuda:0')
Streamline detected to hit both path and box at index: 54, checking now...
Streamline hit box first at index tensor(54, device='cuda:0')
Streamline detected to hit both path and box at index: 56, checking now...
Streamline hit box first at index tensor(56, device='cuda:0')
Streamline detected to hit both path and box at index: 61, checking now...
Streamline hit path limit first at index tensor(61, device='cuda:0')
Streamline detected to hit both path and box at index: 67, checking now...
Streamline hit path limit first at index tensor(67, device='cuda:0')
Streamline detected to hit both path and box at index: 70, checking now...
Streamline hit box first at index tensor(70, device='cuda:0')
Streamline detected to hit both path and box at index: 82, checking now...
Streamline hit path limit first at index tensor(82, device='cuda:0')
Streamline detected to hit both path and box at index: 84, checking now...
Streamline hit box first at index tensor(84, device='cuda:0')
Streamline detected to hit both path and box at index: 86, checking now...
Streamline hit path limit first at index tensor(86, device='cuda:0')
Streamline detected to hit both path and box at index: 91, checking now...
Streamline hit box first at index tensor(91, device='cuda:0')
Streamline detected to hit both path and box at index: 93, checking now...
Streamline hit box first at index tensor(93, device='cuda:0')
Streamline detected to hit both path and box at index: 96, checking now...
Streamline hit box first at index tensor(96, device='cuda:0')
Streamline detected to hit both path and box at index: 112, checking now...
Streamline hit box first at index tensor(112, device='cuda:0')
Streamline detected to hit both path and box at index: 120, checking now...
Streamline hit path limit first at index tensor(120, device='cuda:0')
Streamline detected to hit both path and box at index: 127, checking now...
Streamline hit box first at index tensor(127, device='cuda:0')
Streamline detected to hit both path and box at index: 136, checking now...
Streamline hit box first at index tensor(136, device='cuda:0')
Streamline detected to hit both path and box at index: 137, checking now...
Streamline hit box first at index tensor(137, device='cuda:0')
Streamline detected to hit both path and box at index: 143, checking now...
Streamline hit path limit first at index tensor(143, device='cuda:0')
Streamline detected to hit both path and box at index: 146, checking now...
Streamline hit path limit first at index tensor(146, device='cuda:0')
Streamline detected to hit both path and box at index: 147, checking now...
Streamline hit box first at index tensor(147, device='cuda:0')
Streamline detected to hit both path and box at index: 152, checking now...
Streamline hit box first at index tensor(152, device='cuda:0')
Streamline detected to hit both path and box at index: 157, checking now...
Streamline hit box first at index tensor(157, device='cuda:0')
Streamline detected to hit both path and box at index: 167, checking now...
Streamline hit box first at index tensor(167, device='cuda:0')
Streamline detected to hit both path and box at index: 168, checking now...
Streamline hit box first at index tensor(168, device='cuda:0')
Streamline detected to hit both path and box at index: 169, checking now...
Streamline hit box first at index tensor(169, device='cuda:0')
Streamline detected to hit both path and box at index: 176, checking now...
Streamline hit box first at index tensor(176, device='cuda:0')
Streamline detected to hit both path and box at index: 179, checking now...
Streamline hit box first at index tensor(179, device='cuda:0')
Streamline detected to hit both path and box at index: 184, checking now...
Streamline hit path limit first at index tensor(184, device='cuda:0')
Streamline detected to hit both path and box at index: 189, checking now...
Streamline hit path limit first at index tensor(189, device='cuda:0')
Streamline detected to hit both path and box at index: 196, checking now...
Streamline hit box first at index tensor(196, device='cuda:0')
Streamline detected to hit both path and box at index: 200, checking now...
Streamline hit box first at index tensor(200, device='cuda:0')
Streamline detected to hit both path and box at index: 203, checking now...
Streamline hit box first at index tensor(203, device='cuda:0')
Streamline detected to hit both path and box at index: 209, checking now...
Streamline hit path limit first at index tensor(209, device='cuda:0')
Streamline detected to hit both path and box at index: 212, checking now...
Streamline hit box first at index tensor(212, device='cuda:0')
Streamline detected to hit both path and box at index: 227, checking now...
Streamline hit box first at index tensor(227, device='cuda:0')
Streamline detected to hit both path and box at index: 231, checking now...
Streamline hit path limit first at index tensor(231, device='cuda:0')
Streamline detected to hit both path and box at index: 232, checking now...
Streamline hit box first at index tensor(232, device='cuda:0')
Streamline detected to hit both path and box at index: 234, checking now...
Streamline hit box first at index tensor(234, device='cuda:0')
Streamline detected to hit both path and box at index: 235, checking now...
Streamline hit path limit first at index tensor(235, device='cuda:0')
Streamline detected to hit both path and box at index: 237, checking now...
Streamline hit path limit first at index tensor(237, device='cuda:0')
Streamline detected to hit both path and box at index: 246, checking now...
Streamline hit path limit first at index tensor(246, device='cuda:0')
Streamline detected to hit both path and box at index: 248, checking now...
Streamline hit path limit first at index tensor(248, device='cuda:0')
Streamline detected to hit both path and box at index: 265, checking now...
Streamline hit box first at index tensor(265, device='cuda:0')
Streamline detected to hit both path and box at index: 268, checking now...
Streamline hit path limit first at index tensor(268, device='cuda:0')
Streamline detected to hit both path and box at index: 274, checking now...
Streamline hit box first at index tensor(274, device='cuda:0')
Streamline detected to hit both path and box at index: 276, checking now...
Streamline hit box first at index tensor(276, device='cuda:0')
Streamline detected to hit both path and box at index: 281, checking now...
Streamline hit path limit first at index tensor(281, device='cuda:0')
Streamline detected to hit both path and box at index: 282, checking now...
Streamline hit box first at index tensor(282, device='cuda:0')
Streamline detected to hit both path and box at index: 297, checking now...
Streamline hit box first at index tensor(297, device='cuda:0')
Streamline detected to hit both path and box at index: 299, checking now...
Streamline hit path limit first at index tensor(299, device='cuda:0')
Streamline detected to hit both path and box at index: 303, checking now...
Streamline hit path limit first at index tensor(303, device='cuda:0')
Streamline detected to hit both path and box at index: 308, checking now...
Streamline hit box first at index tensor(308, device='cuda:0')
Streamline detected to hit both path and box at index: 311, checking now...
Streamline hit path limit first at index tensor(311, device='cuda:0')
Streamline detected to hit both path and box at index: 312, checking now...
Streamline hit box first at index tensor(312, device='cuda:0')
Streamline detected to hit both path and box at index: 315, checking now...
Streamline hit box first at index tensor(315, device='cuda:0')
Streamline detected to hit both path and box at index: 316, checking now...
Streamline hit box first at index tensor(316, device='cuda:0')
Streamline detected to hit both path and box at index: 317, checking now...
Streamline hit box first at index tensor(317, device='cuda:0')
Streamline detected to hit both path and box at index: 325, checking now...
Streamline hit path limit first at index tensor(325, device='cuda:0')
Streamline detected to hit both path and box at index: 331, checking now...
Streamline hit path limit first at index tensor(331, device='cuda:0')
Streamline detected to hit both path and box at index: 332, checking now...
Streamline hit box first at index tensor(332, device='cuda:0')
Streamline detected to hit both path and box at index: 333, checking now...
Streamline hit path limit first at index tensor(333, device='cuda:0')
Streamline detected to hit both path and box at index: 337, checking now...
Streamline hit path limit first at index tensor(337, device='cuda:0')
Streamline detected to hit both path and box at index: 340, checking now...
Streamline hit box first at index tensor(340, device='cuda:0')
Streamline detected to hit both path and box at index: 341, checking now...
Streamline hit box first at index tensor(341, device='cuda:0')
Now have 941 number of dumped streamlines after filtering.
Number of streamlines filtered: 285
941
Filtering...
Streamline detected to hit both path and box at index: 0, checking now...
Streamline hit box first at index tensor(0, device='cuda:0')
Streamline detected to hit both path and box at index: 1, checking now...
Streamline hit box first at index tensor(1, device='cuda:0')
Streamline detected to hit both path and box at index: 3, checking now...
Streamline hit box first at index tensor(3, device='cuda:0')
Streamline detected to hit both path and box at index: 10, checking now...
Streamline hit box first at index tensor(10, device='cuda:0')
Streamline detected to hit both path and box at index: 11, checking now...
Streamline hit path limit first at index tensor(11, device='cuda:0')
Streamline detected to hit both path and box at index: 12, checking now...
Streamline hit box first at index tensor(12, device='cuda:0')
Streamline detected to hit both path and box at index: 13, checking now...
Streamline hit path limit first at index tensor(13, device='cuda:0')
Streamline detected to hit both path and box at index: 17, checking now...
Streamline hit path limit first at index tensor(17, device='cuda:0')
Streamline detected to hit both path and box at index: 19, checking now...
Streamline hit path limit first at index tensor(19, device='cuda:0')
Streamline detected to hit both path and box at index: 22, checking now...
Streamline hit box first at index tensor(22, device='cuda:0')
Streamline detected to hit both path and box at index: 23, checking now...
Streamline hit box first at index tensor(23, device='cuda:0')
Streamline detected to hit both path and box at index: 28, checking now...
Streamline hit path limit first at index tensor(28, device='cuda:0')
Streamline detected to hit both path and box at index: 30, checking now...
Streamline hit path limit first at index tensor(30, device='cuda:0')
Streamline detected to hit both path and box at index: 31, checking now...
Streamline hit box first at index tensor(31, device='cuda:0')
Streamline detected to hit both path and box at index: 36, checking now...
Streamline hit path limit first at index tensor(36, device='cuda:0')
Streamline detected to hit both path and box at index: 37, checking now...
Streamline hit box first at index tensor(37, device='cuda:0')
Streamline detected to hit both path and box at index: 46, checking now...
Streamline hit path limit first at index tensor(46, device='cuda:0')
Streamline detected to hit both path and box at index: 50, checking now...
Streamline hit path limit first at index tensor(50, device='cuda:0')
Streamline detected to hit both path and box at index: 55, checking now...
Streamline hit box first at index tensor(55, device='cuda:0')
Streamline detected to hit both path and box at index: 56, checking now...
Streamline hit path limit first at index tensor(56, device='cuda:0')
Streamline detected to hit both path and box at index: 57, checking now...
Streamline hit path limit first at index tensor(57, device='cuda:0')
Streamline detected to hit both path and box at index: 58, checking now...
Streamline hit box first at index tensor(58, device='cuda:0')
Now have 993 number of dumped streamlines after filtering.
Number of streamlines filtered: 52
993
Filtering...
Streamline detected to hit both path and box at index: 0, checking now...
Streamline hit box first at index tensor(0, device='cuda:0')
Streamline detected to hit both path and box at index: 2, checking now...
Streamline hit box first at index tensor(2, device='cuda:0')
Streamline detected to hit both path and box at index: 3, checking now...
Streamline hit box first at index tensor(3, device='cuda:0')
Streamline detected to hit both path and box at index: 4, checking now...
Streamline hit path limit first at index tensor(4, device='cuda:0')
Streamline detected to hit both path and box at index: 6, checking now...
Streamline hit box first at index tensor(6, device='cuda:0')
Now have 1000 number of dumped streamlines after filtering.
Number of streamlines filtered: 7
1000
Finished streamlines early, breaking!
Checking dumped values (1000) vs number of samples (1000)
torch.Size([6, 1000, 3])
Time taken for 1000 calculations with N~(17391, 1): 1.69 seconds
(1000, 2)
=============================== warnings summary ===============================
../CPET/utils/calculator.py:3
  /jet/home/ajmera/programs/CPET-python/CPET/utils/calculator.py:3: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../../.conda/envs/CPET_ENV/lib/python3.11/site-packages/pkg_resources/__init__.py:2871
  /jet/home/ajmera/.conda/envs/CPET_ENV/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('mpl_toolkits')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

tests/test_topology.py::Test_topos::test_topo_methods
  /jet/home/ajmera/programs/CPET-python/CPET/source/calculator.py:555: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
    path_filter = torch.tensor(path_filter, dtype=torch.bool).cuda()

tests/test_topology.py::Test_topos::test_topo_methods
  /jet/home/ajmera/programs/CPET-python/CPET/source/calculator.py:655: UserWarning: Using torch.cross without specifying the dim arg is deprecated.
  Please either pass the dim explicitly or simply use torch.linalg.cross.
  The default value of dim will change to agree with that of linalg.cross in a future release. (Triggered internally at ../aten/src/ATen/native/Cross.cpp:63.)
    distances, curvatures = compute_curv_and_dist_mat_gpu(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED test_topology.py::Test_topos::test_topo_methods - AssertionError: 
=================== 1 failed, 4 warnings in 95.14s (0:01:35) ===================
